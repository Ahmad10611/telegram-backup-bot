### ربات پشتیبان‌گیری تلگرام - راهنمای کامل

**توضیحات:**
یک ربات تلگرام برای خودکارسازی فرآیند پشتیبان‌گیری از دیتابیس MySQL و ارسال فایل‌های پشتیبان از طریق تلگرام. این ربات به گونه‌ای طراحی شده که پشتیبان‌گیری‌های زمان‌بندی‌شده را به طور منظم انجام داده و فایل‌ها را به صورت امن از طریق API تلگرام ارسال کند. همچنین از **PM2** برای مدیریت مداوم فرآیند ربات استفاده می‌شود.

### ویژگی‌های کلیدی:
- پشتیبان‌گیری خودکار از دیتابیس MySQL.
- ارسال خودکار فایل‌های پشتیبان از طریق تلگرام.
- مدیریت مداوم فرآیند با **PM2**.
- سازگار با توزیع‌های لینوکسی محبوب (Debian، Ubuntu، CentOS).

---

### نیازمندی‌ها:
1. یک سرور لینوکسی که **Debian/Ubuntu** یا **RHEL/CentOS** را اجرا می‌کند.
2. نصب و پیکربندی **MySQL**.
3. **Python 3.8** یا بالاتر.
4. **Node.js** نسخه 16 یا بالاتر برای مدیریت ربات با **PM2**.
5. توکن ربات تلگرام و آیدی عددی کاربر مجاز (authorized user ID).

---

### دستورالعمل‌های نصب

#### 1. کلون کردن مخزن
ابتدا مخزن ربات را به سرور خود کلون کنید:

```bash
git clone https://github.com/Ahmad10611/telegram-backup-bot.git
cd telegram-backup-bot
```

#### 2. اجرای اسکریپت نصب
اسکریپت نصب تمام وابستگی‌ها را نصب می‌کند، اطلاعات لازم را از شما دریافت می‌کند و ربات را با **PM2** راه‌اندازی می‌کند.

```bash
chmod +x setup.sh
./setup.sh
```

در حین نصب، اسکریپت از شما موارد زیر را درخواست خواهد کرد:

- **توکن ربات تلگرام**: می‌توانید این توکن را از [BotFather](https://t.me/BotFather) دریافت کنید.
- **آیدی عددی کاربر مجاز**: این آیدی عددی تلگرام شما است که می‌توانید آن را از ربات‌هایی مانند [userinfobot](https://t.me/userinfobot) دریافت کنید.
- **نام کاربری MySQL**: نام کاربری دیتابیس MySQL.
- **رمز عبور MySQL**: رمز عبور برای دسترسی به MySQL.
- **نام دیتابیس MySQL**: نام دیتابیسی که قصد پشتیبان‌گیری از آن را دارید.
- **هاست MySQL**: معمولاً `localhost` است.

---

### جریان نصب نمونه:

```bash
Please enter your Telegram bot token: <YOUR_BOT_TOKEN>
Please enter the authorized user ID (your Telegram numeric ID): <YOUR_USER_ID>
Please enter your MySQL username: <MYSQL_USER>
Please enter your MySQL password: <MYSQL_PASSWORD>
Please enter your MySQL database name: <MYSQL_DATABASE>
Please enter your MySQL database host (e.g., localhost): localhost
```

پس از وارد کردن اطلاعات، اسکریپت به ترتیب:

1. وابستگی‌های سیستم (مانند `Python3.8`، `MySQL client`، `Node.js` و غیره) را نصب می‌کند.
2. کتابخانه‌های پایتون (مانند `mysql-connector-python`، `apscheduler`، `python-telegram-bot` و غیره) را نصب می‌کند.
3. **PM2** را نصب و پیکربندی می‌کند تا ربات به صورت مداوم اجرا شود.
4. ربات را با استفاده از **PM2** اجرا می‌کند.

---

### نحوه استفاده

#### مشاهده لاگ‌های ربات:
برای مشاهده لاگ‌های ربات (جهت نظارت یا رفع اشکال)، از دستور زیر استفاده کنید:

```bash
pm2 logs telegram-backup-bot
```

#### متوقف کردن ربات:
برای متوقف کردن ربات در هر زمانی:

```bash
pm2 stop telegram-backup-bot
```

#### راه‌اندازی مجدد ربات:
برای راه‌اندازی مجدد ربات:

```bash
pm2 restart telegram-backup-bot
```

#### مشاهده فرآیندهای در حال اجرا:
برای مشاهده لیست فرآیندهای مدیریت شده توسط **PM2**:

```bash
pm2 list
```

---

### نصب دستی (اگر از اسکریپت نصب استفاده نمی‌کنید):

#### 1. نصب وابستگی‌های سیستم
برای **Debian/Ubuntu**:
```bash
sudo apt update
sudo apt install -y python3.8 python3.8-venv python3.8-dev python3-pip mariadb-client libmariadb-dev curl nodejs npm
```

برای **RHEL/CentOS**:
```bash
sudo yum install -y python3.8 python3.8-venv python3.8-dev python3-pip mariadb curl nodejs npm
```

#### 2. نصب کتابخانه‌های پایتون
کتابخانه‌های مورد نیاز پایتون را با استفاده از `pip` نصب کنید:

```bash
pip3 install -r requirements.txt
```

#### 3. نصب PM2 و اجرای ربات
**PM2** را به صورت سراسری نصب کنید:

```bash
npm install pm2@latest -g
```

ربات را با **PM2** اجرا کنید:

```bash
pm2 start telegram_bot.py --name telegram-backup-bot
```

مطمئن شوید **PM2** در هنگام راه‌اندازی سیستم به صورت خودکار اجرا می‌شود:

```bash
pm2 save
pm2 startup
```

---

### رفع اشکال

- **خطای syntax در لاگ‌های PM2**: مطمئن شوید که از Python 3.8 یا بالاتر استفاده می‌کنید. برخی از دستورات جدید پایتون (مانند `f-strings`) ممکن است با نسخه‌های قدیمی‌تر سازگار نباشند.
- **ارسال نکردن پیام توسط ربات**: مطمئن شوید که توکن ربات تلگرام و آیدی عددی کاربر مجاز درست وارد شده‌اند. می‌توانید اعتبار توکن ربات خود را از طریق [BotFather](https://t.me/BotFather) بررسی کنید.
- **مشکلات اتصال به دیتابیس**: مطمئن شوید که اطلاعات ورود به MySQL صحیح است و سرور MySQL در حال اجرا است.

---

### مشارکت
می‌توانید با ارائه مشکلات یا درخواست‌های pull در GitHub به این پروژه کمک کنید. برای هرگونه سوال به مستندات مخزن مراجعه کنید یا از بخش issues سوالات خود را مطرح کنید.

---

این راهنمایی به شما نشان می‌دهد که چگونه ربات پشتیبان‌گیری تلگرام را در سرور لینوکسی خود با زمان‌بندی خودکار و ارسال فایل‌های پشتیبان راه‌اندازی و مدیریت کنید.